# 快速端点测试功能

新增功能允许你在每次请求前对所有端点进行并行测试，并缓存结果以避免重复测试。

## 功能特性

### 🚀 并行测试
- 同时测试所有健康端点
- 测量实时响应时间
- 快速识别当前最快的端点

### ⚡ 智能缓存
- 短期缓存测试结果
- 避免频繁请求时的重复测试
- 可配置缓存时长

### 🎯 实时选择
- 基于实时测试结果选择端点
- 不依赖于定期健康检查的过时数据
- 动态适应网络变化

## 配置示例

```yaml
strategy:
  type: "fastest"
  # 启用快速测试 (仅对 "fastest" 策略生效)
  fast_test_enabled: true
  # 测试结果缓存时间 (避免频繁请求时重复测试)
  fast_test_cache_ttl: "3s"
  # 单个测试超时时间 (应该设置较短)
  fast_test_timeout: "1s"
  # 用于快速测试的路径 (未指定时使用 health_path)
  fast_test_path: "/v1/models"
```

## 使用场景

### 场景1: 高频API调用
当你有大量API请求时，3秒的缓存避免了每次请求都进行测试，同时保证了足够的实时性。

### 场景2: 网络条件变化
当网络条件或端点性能发生变化时，快速测试能够立即反映这些变化，而不需要等待30秒的健康检查周期。

### 场景3: 精确的延迟优化
对于需要最低延迟的应用，这个功能提供了比定期健康检查更精确的端点选择。

## 工作流程

1. **请求到达** → 触发端点选择
2. **检查缓存** → 如果缓存有效，直接使用缓存结果
3. **并行测试** → 如果缓存过期，并行测试所有健康端点
4. **排序选择** → 按响应时间排序，选择最快的端点
5. **更新缓存** → 缓存测试结果供后续使用
6. **转发请求** → 使用选定的端点处理请求

## 性能影响

- **启用时**: 首次请求会有额外的测试延迟(通常<1秒)，后续请求使用缓存
- **禁用时**: 使用定期健康检查的结果，无额外延迟

## 配置建议

- `fast_test_timeout`: 建议设置为 0.5-2 秒
- `fast_test_cache_ttl`: 建议设置为 1-5 秒
- `fast_test_path`: 使用轻量级的端点，如 `/v1/models`